# Data API Documentation

## Overview

The Data API interface is a declarative tool for building RESTful APIs with automatic CRUD
operations, with built-in validation, and access control. It offers a seamless way to expose
your database models as web services with minimal boilerplate.

## Key Features

- **Expose Database Models**: link your database to your API endpoints.
- **Customizable** default endpoints work for most use cases, but still can be customized for specific needs.
- **Access Control**: set read/write permissions on specific fields.
- **Validation**: define validation rules per field.
- **Listable Fields**: control which fields appear in list operations, and how the pagination works.
- **Sorting**: sort results by specific fields, customizable per field.

## Dependencies

This interface relies on the following AntelopeJS modules:
- [API](https://github.com/AntelopeJS/api) - required for creating API controllers.
- [Database Decorators](https://github.com/AntelopeJS/database-decorators) - for defining database tables and models.

## Quick Start

Here's a minimal example to get you started:

```typescript
import { DataController, DefaultRoutes, RegisterDataController } from '@ajs/data-api/beta';
import { Controller } from '@ajs/api/beta';
import { Table, Index, RegisterTable, BasicDataModel, StaticModel } from '@ajs/database-decorators/beta';
import { Access, AccessMode, Listable, Mandatory, ModelReference } from '@ajs/data-api/beta/metadata';

const tableName = 'users';

// Define your database table
@RegisterTable(tableName)
class User extends Table {
    @Index({ primary: true })
    declare _id: string;

    @Index()
    declare email: string;

    declare age: number;
}

// Create your database model
class UserModel extends BasicDataModel(User, tableName) {}

// Create your Data API controller
@RegisterDataController()
class UserAPI extends DataController(User, DefaultRoutes.All, Controller('/users')) {
    @ModelReference()
    @StaticModel(UserModel, 'my-database')
    declare userModel: UserModel;

    @Listable()                       // Will be shown in list operations
    @Access(AccessMode.ReadOnly)      // Read-only, cannot be overwritten
    declare _id: string;

    @Listable()
    @Access(AccessMode.ReadWrite)     // Can be read and overwritten
    @Mandatory('new', 'edit')         // Required for create and update operations
    declare email: string;

    @Access(AccessMode.Write)         // Can be overwritten, but cannot be shown in list or get
    @Mandatory('new')                 // Required only for create operations
    declare password: string;
}
```

This creates the following REST endpoints:

- `(GET) - /users/get?id=7c451033` - Fetch user `7c451033`
- `(GET) - /users/list?limit=10` - List users with pagination
- `(POST) - /users/new` - Create a new user
- `(PUT) - /users/edit?id=7c451033` - Update user `7c451033`
- `(DELETE) - /users/delete?id=7c451033` - Delete user `7c451033`

## Documentation Sections

- [Data Controllers](./2.data-controllers.md) - Creating and using Data API controllers
- [Routes](./3.routes.md) - Understanding and customizing API endpoints
- [Access Rights](./4.access-rights.md) - Controlling field read/write permissions
- [Validators](./5.validators.md) - Adding field-level validation
- [Listable Fields](./6.listable.md) - Managing field visibility in list operations
- [Foreign Keys](./7.foreign-keys.md) - Establishing relationships between tables
- [Filters](./8.filters.md) - Adding filtering capabilities to list operations
